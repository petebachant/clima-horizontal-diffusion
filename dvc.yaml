stages:
  gen-smag-state:
    cmd: calkit slurm batch --name gen-smag-state --environment clima 
      --dep scripts/gen_smag_state.jl --dep config/base.yml --dep 
      config/smag.yml --dep ClimaAtmos.jl/src --dep ClimaAtmos.jl/toml
      --dep ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml --out 
      results/smag_fixture.jld2 -s --gpus=1 -s --time=30 -- 
      scripts/run.sh ClimaAtmos.jl/.buildkite 
      scripts/gen_smag_state.jl
    deps:
      - scripts/run.sh
      - scripts/gen_smag_state.jl
      - config/base.yml
      - config/smag.yml
      - ClimaAtmos.jl/src
      - ClimaAtmos.jl/toml
      - ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml
    outs:
      - results/smag_fixture.jld2:
          cache: false
          persist: true
      - .calkit/slurm/logs/gen-smag-state.out:
          cache: false
          persist: true
    desc: Automatically generated from the 'gen-smag-state' stage in 
      calkit.yaml. Changes made here will be overwritten.
  nsys-baseline:
    cmd: calkit slurm batch --name nsys-baseline --environment clima 
      --dep config/base.yml --dep config/smag.yml --dep 
      ClimaAtmos.jl/src --dep ClimaAtmos.jl/toml --dep 
      ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml --dep 
      ClimaAtmos.jl/perf/benchmark_step.jl --out 
      results/nsys/baseline.nsys-rep -s --gpus=1 -s --time=60 -- 
      scripts/run-nsys.sh results/nsys/baseline 
      ClimaAtmos.jl/.buildkite config/base.yml config/smag.yml
    deps:
      - scripts/run-nsys.sh
      - config/base.yml
      - config/smag.yml
      - ClimaAtmos.jl/src
      - ClimaAtmos.jl/toml
      - ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml
      - ClimaAtmos.jl/perf/benchmark_step.jl
    outs:
      - results/nsys/baseline.nsys-rep:
          persist: true
      - .calkit/slurm/logs/nsys-baseline.out:
          cache: false
          persist: true
    desc: Automatically generated from the 'nsys-baseline' stage in 
      calkit.yaml. Changes made here will be overwritten.
