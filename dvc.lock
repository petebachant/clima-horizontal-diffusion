schema: '2.0'
stages:
  gen-smag-state:
    cmd: calkit slurm batch --name gen-smag-state --environment clima --dep 
      scripts/gen_smag_state.jl --dep config/base.yml --dep config/smag.yml 
      --dep ClimaAtmos.jl/src --dep ClimaAtmos.jl/toml --dep 
      ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml --out 
      results/smag_fixture.jld2 -s --gpus=1 -s --time=30 -- scripts/run.sh 
      ClimaAtmos.jl/.buildkite scripts/gen_smag_state.jl
    deps:
    - path: ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml
      hash: md5
      md5: 960b94f8e8dc62e1ef00310b21171099
      size: 106103
    - path: ClimaAtmos.jl/src
      hash: md5
      md5: 01e1d1b04e003a8a54f22f5da3dc6465.dir
      size: 1317233
      nfiles: 101
    - path: ClimaAtmos.jl/toml
      hash: md5
      md5: f6943f469c23e41ed04469503e7b9563.dir
      size: 11921
      nfiles: 36
    - path: config/base.yml
      hash: md5
      md5: 4756cdb867a59bff0c1f2cb99084db18
      size: 3659
    - path: config/smag.yml
      hash: md5
      md5: d953bd59bd767f59488f1b95350864c4
      size: 22
    - path: scripts/gen_smag_state.jl
      hash: md5
      md5: 35245dd10e4970910f68f2b71d3e3ba4
      size: 1449
    - path: scripts/run.sh
      hash: md5
      md5: 55b895adbb65f6511b237e4d2cde9f25
      size: 1014
    outs:
    - path: .calkit/slurm/logs/gen-smag-state.out
      hash: md5
      md5: 446a0448350a809551bbabbd0d012435
      size: 10088
    - path: results/smag_fixture.jld2
      hash: md5
      md5: ee30c111977c5e5872148cda070a2480
      size: 1279337013
  nsys-baseline:
    cmd: calkit slurm batch --name nsys-baseline --environment clima --dep 
      config/base.yml --dep config/smag.yml --dep ClimaAtmos.jl/src --dep 
      ClimaAtmos.jl/toml --dep ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml 
      --dep ClimaAtmos.jl/perf/benchmark_step.jl --out 
      results/nsys/baseline.nsys-rep -s --gpus=1 -s --time=60 -- 
      scripts/run-nsys.sh results/nsys/baseline ClimaAtmos.jl/.buildkite 
      config/base.yml config/smag.yml
    deps:
    - path: ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml
      hash: md5
      md5: 960b94f8e8dc62e1ef00310b21171099
      size: 106103
    - path: ClimaAtmos.jl/perf/benchmark_step.jl
      hash: md5
      md5: e4e56e0353b6c5130c4e3fc03082c211
      size: 2082
    - path: ClimaAtmos.jl/src
      hash: md5
      md5: 01e1d1b04e003a8a54f22f5da3dc6465.dir
      size: 1317233
      nfiles: 101
    - path: ClimaAtmos.jl/toml
      hash: md5
      md5: f6943f469c23e41ed04469503e7b9563.dir
      size: 11921
      nfiles: 36
    - path: config/base.yml
      hash: md5
      md5: 4756cdb867a59bff0c1f2cb99084db18
      size: 3659
    - path: config/smag.yml
      hash: md5
      md5: d953bd59bd767f59488f1b95350864c4
      size: 22
    - path: scripts/run-nsys.sh
      hash: md5
      md5: f83d8ec0a4bd8e2cd5513b64079b7b02
      size: 1546
    outs:
    - path: .calkit/slurm/logs/nsys-baseline.out
      hash: md5
      md5: 48c15744d7c03efdb3719fc6a94751e3
      size: 14113
    - path: results/nsys/baseline.nsys-rep
      hash: md5
      md5: 99bc83c8e8543c5723cbec15147d1113
      size: 5379040
  nsys-baseline-to-sqlite:
    cmd: ' bash --noprofile --norc -c "nsys export results/nsys/baseline.nsys-rep
      -t sqlite -o results/nsys/baseline.sqlite"'
    deps:
    - path: results/nsys/baseline.nsys-rep
      hash: md5
      md5: 99bc83c8e8543c5723cbec15147d1113
      size: 5379040
    outs:
    - path: results/nsys/baseline.sqlite
      hash: md5
      md5: 2e9785b1cd708f26415974b37f13d0fa
      size: 10678272
  nsys-mod:
    cmd: calkit slurm batch --name nsys-mod --environment clima --dep 
      config/base.yml --dep config/smag.yml --dep ClimaAtmos.jl-mod/src --dep 
      ClimaAtmos.jl-mod/toml --dep 
      ClimaAtmos.jl-mod/.buildkite/Manifest-v1.11.toml --dep 
      ClimaAtmos.jl/perf/benchmark_step.jl --out results/nsys/mod.nsys-rep -s 
      --gpus=1 -s --time=60 -- scripts/run-nsys.sh results/nsys/mod 
      ClimaAtmos.jl-mod/.buildkite config/base.yml config/smag.yml
    deps:
    - path: ClimaAtmos.jl-mod/.buildkite/Manifest-v1.11.toml
      hash: md5
      md5: 960b94f8e8dc62e1ef00310b21171099
      size: 106103
    - path: ClimaAtmos.jl-mod/src
      hash: md5
      md5: b96bc17213628953a4cb6a94c991cf68.dir
      size: 1317147
      nfiles: 101
    - path: ClimaAtmos.jl-mod/toml
      hash: md5
      md5: f6943f469c23e41ed04469503e7b9563.dir
      size: 11921
      nfiles: 36
    - path: ClimaAtmos.jl/perf/benchmark_step.jl
      hash: md5
      md5: e4e56e0353b6c5130c4e3fc03082c211
      size: 2082
    - path: config/base.yml
      hash: md5
      md5: 4756cdb867a59bff0c1f2cb99084db18
      size: 3659
    - path: config/smag.yml
      hash: md5
      md5: d953bd59bd767f59488f1b95350864c4
      size: 22
    - path: scripts/run-nsys.sh
      hash: md5
      md5: f83d8ec0a4bd8e2cd5513b64079b7b02
      size: 1546
    outs:
    - path: .calkit/slurm/logs/nsys-mod.out
      hash: md5
      md5: d0a101e4ee2aadfb1a09d7b7a48d4925
      size: 13841
    - path: results/nsys/mod.nsys-rep
      hash: md5
      md5: 39a36761584e60449a61083980d59ddf
      size: 5333348
  nsys-mod-to-sqlite:
    cmd: ' bash --noprofile --norc -c "nsys export results/nsys/mod.nsys-rep -t sqlite
      -o results/nsys/mod.sqlite"'
    deps:
    - path: results/nsys/mod.nsys-rep
      hash: md5
      md5: 39a36761584e60449a61083980d59ddf
      size: 5333348
    outs:
    - path: results/nsys/mod.sqlite
      hash: md5
      md5: d139485c9f40a6210b6a5f1416b1505b
      size: 10612736
  nsys-baseline-const:
    cmd: calkit slurm batch --name nsys-baseline-const --environment clima --dep
      config/base.yml --dep config/const.yml --dep ClimaAtmos.jl/src --dep 
      ClimaAtmos.jl/toml --dep ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml 
      --dep ClimaAtmos.jl/perf/benchmark_step.jl --out 
      results/nsys/baseline-const.nsys-rep -s --gpus=1 -s --time=60 -- 
      scripts/run-nsys.sh results/nsys/baseline-const ClimaAtmos.jl/.buildkite 
      config/base.yml config/const.yml
    deps:
    - path: ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml
      hash: md5
      md5: 960b94f8e8dc62e1ef00310b21171099
      size: 106103
    - path: ClimaAtmos.jl/perf/benchmark_step.jl
      hash: md5
      md5: e4e56e0353b6c5130c4e3fc03082c211
      size: 2082
    - path: ClimaAtmos.jl/src
      hash: md5
      md5: 01e1d1b04e003a8a54f22f5da3dc6465.dir
      size: 1317233
      nfiles: 101
    - path: ClimaAtmos.jl/toml
      hash: md5
      md5: f6943f469c23e41ed04469503e7b9563.dir
      size: 11921
      nfiles: 36
    - path: config/base.yml
      hash: md5
      md5: 4756cdb867a59bff0c1f2cb99084db18
      size: 3659
    - path: config/const.yml
      hash: md5
      md5: 77bc7b925c754338d9602a945c8888ce
      size: 36
    - path: scripts/run-nsys.sh
      hash: md5
      md5: f83d8ec0a4bd8e2cd5513b64079b7b02
      size: 1546
    outs:
    - path: .calkit/slurm/logs/nsys-baseline-const.out
      hash: md5
      md5: 86ebcd75197a56a1046f9e56e542f9de
      size: 14292
    - path: results/nsys/baseline-const.nsys-rep
      hash: md5
      md5: b5cce117bf44d6f2399db8d44fc2f684
      size: 5076263
  nsys-baseline-const-to-sqlite:
    cmd: ' bash --noprofile --norc -c "nsys export results/nsys/baseline-const.nsys-rep
      -t sqlite -o results/nsys/baseline-const.sqlite"'
    deps:
    - path: results/nsys/baseline-const.nsys-rep
      hash: md5
      md5: b5cce117bf44d6f2399db8d44fc2f684
      size: 5076263
    outs:
    - path: results/nsys/baseline-const.sqlite
      hash: md5
      md5: a55bd541dea529b16df6e215e2b21472
      size: 10121216
  nsys-baseline-none:
    cmd: calkit slurm batch --name nsys-baseline-none --environment clima --dep 
      config/base.yml --dep ClimaAtmos.jl/src --dep ClimaAtmos.jl/toml --dep 
      ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml --dep 
      ClimaAtmos.jl/perf/benchmark_step.jl --out 
      results/nsys/baseline-none.nsys-rep -s --gpus=1 -s --time=60 -- 
      scripts/run-nsys.sh results/nsys/baseline-none ClimaAtmos.jl/.buildkite 
      config/base.yml
    deps:
    - path: ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml
      hash: md5
      md5: 960b94f8e8dc62e1ef00310b21171099
      size: 106103
    - path: ClimaAtmos.jl/perf/benchmark_step.jl
      hash: md5
      md5: e4e56e0353b6c5130c4e3fc03082c211
      size: 2082
    - path: ClimaAtmos.jl/src
      hash: md5
      md5: 01e1d1b04e003a8a54f22f5da3dc6465.dir
      size: 1317233
      nfiles: 101
    - path: ClimaAtmos.jl/toml
      hash: md5
      md5: f6943f469c23e41ed04469503e7b9563.dir
      size: 11921
      nfiles: 36
    - path: config/base.yml
      hash: md5
      md5: 4756cdb867a59bff0c1f2cb99084db18
      size: 3659
    - path: scripts/run-nsys.sh
      hash: md5
      md5: f83d8ec0a4bd8e2cd5513b64079b7b02
      size: 1546
    outs:
    - path: .calkit/slurm/logs/nsys-baseline-none.out
      hash: md5
      md5: 268ed27dc982e8b4b162a45434c42d86
      size: 13960
    - path: results/nsys/baseline-none.nsys-rep
      hash: md5
      md5: 379b26cdc4f73f25d756279fc6bc89da
      size: 5010493
  nsys-baseline-none-to-sqlite:
    cmd: ' bash --noprofile --norc -c "nsys export results/nsys/baseline-none.nsys-rep
      -t sqlite -o results/nsys/baseline-none.sqlite"'
    deps:
    - path: results/nsys/baseline-none.nsys-rep
      hash: md5
      md5: 379b26cdc4f73f25d756279fc6bc89da
      size: 5010493
    outs:
    - path: results/nsys/baseline-none.sqlite
      hash: md5
      md5: 3bcf85c356fcdf3147b66512484d613e
      size: 9949184
  summarize:
    cmd: calkit xenv -n py --no-check -- python scripts/summarize.py
    deps:
    - path: .calkit/env-locks/py
      hash: md5
      md5: 996b8e3f972c2d2602957c2486ba7dc5.dir
      size: 1011
      nfiles: 1
    - path: results/nsys/baseline-const.sqlite
      hash: md5
      md5: a55bd541dea529b16df6e215e2b21472
      size: 10121216
    - path: results/nsys/baseline.sqlite
      hash: md5
      md5: 2e9785b1cd708f26415974b37f13d0fa
      size: 10678272
    - path: results/nsys/mod.sqlite
      hash: md5
      md5: d139485c9f40a6210b6a5f1416b1505b
      size: 10612736
    - path: scripts/summarize.py
      hash: md5
      md5: 9680b4b22573e920059ece0b52a99227
      size: 837
    outs:
    - path: results/summary.csv
      hash: md5
      md5: cbc9a74b8f30d0c9e9d90e8fafa33341
      size: 351
