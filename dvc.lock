schema: '2.0'
stages:
  gen-smag-state:
    cmd: calkit slurm batch --name gen-smag-state --environment clima --dep 
      scripts/gen_smag_state.jl --dep config/base.yml --dep config/smag.yml 
      --dep ClimaAtmos.jl/src --dep ClimaAtmos.jl/toml --dep 
      ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml --out 
      results/smag_fixture.jld2 -s --gpus=1 -s --time=30 -- scripts/run.sh 
      ClimaAtmos.jl/.buildkite scripts/gen_smag_state.jl
    deps:
    - path: ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml
      hash: md5
      md5: 960b94f8e8dc62e1ef00310b21171099
      size: 106103
    - path: ClimaAtmos.jl/src
      hash: md5
      md5: 01e1d1b04e003a8a54f22f5da3dc6465.dir
      size: 1317233
      nfiles: 101
    - path: ClimaAtmos.jl/toml
      hash: md5
      md5: f6943f469c23e41ed04469503e7b9563.dir
      size: 11921
      nfiles: 36
    - path: config/base.yml
      hash: md5
      md5: 4756cdb867a59bff0c1f2cb99084db18
      size: 3659
    - path: config/smag.yml
      hash: md5
      md5: d953bd59bd767f59488f1b95350864c4
      size: 22
    - path: scripts/gen_smag_state.jl
      hash: md5
      md5: 35245dd10e4970910f68f2b71d3e3ba4
      size: 1449
    - path: scripts/run.sh
      hash: md5
      md5: 55b895adbb65f6511b237e4d2cde9f25
      size: 1014
    outs:
    - path: .calkit/slurm/logs/gen-smag-state.out
      hash: md5
      md5: 0679231e07bbaf36540d4e739ae05232
      size: 10489
    - path: results/smag_fixture.jld2
      hash: md5
      md5: ee30c111977c5e5872148cda070a2480
      size: 1279337013
  nsys-baseline:
    cmd: calkit slurm batch --name nsys-baseline --environment clima --dep 
      config/base.yml --dep config/smag.yml --dep ClimaAtmos.jl/src --dep 
      ClimaAtmos.jl/toml --dep ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml 
      --dep ClimaAtmos.jl/perf/benchmark_step.jl --out 
      results/nsys/baseline.nsys-rep -s --gpus=1 -s --time=60 -- 
      scripts/run-nsys.sh results/nsys/baseline ClimaAtmos.jl/.buildkite 
      config/base.yml config/smag.yml
    deps:
    - path: ClimaAtmos.jl/.buildkite/Manifest-v1.11.toml
      hash: md5
      md5: 960b94f8e8dc62e1ef00310b21171099
      size: 106103
    - path: ClimaAtmos.jl/perf/benchmark_step.jl
      hash: md5
      md5: e4e56e0353b6c5130c4e3fc03082c211
      size: 2082
    - path: ClimaAtmos.jl/src
      hash: md5
      md5: 01e1d1b04e003a8a54f22f5da3dc6465.dir
      size: 1317233
      nfiles: 101
    - path: ClimaAtmos.jl/toml
      hash: md5
      md5: f6943f469c23e41ed04469503e7b9563.dir
      size: 11921
      nfiles: 36
    - path: config/base.yml
      hash: md5
      md5: 4756cdb867a59bff0c1f2cb99084db18
      size: 3659
    - path: config/smag.yml
      hash: md5
      md5: d953bd59bd767f59488f1b95350864c4
      size: 22
    - path: scripts/run-nsys.sh
      hash: md5
      md5: f83d8ec0a4bd8e2cd5513b64079b7b02
      size: 1546
    outs:
    - path: .calkit/slurm/logs/nsys-baseline.out
      hash: md5
      md5: 8651a6a03280f023e171fb01c85142a5
      size: 13894
    - path: results/nsys/baseline.nsys-rep
      hash: md5
      md5: 9053a606dafce7693f47f509a7217090
      size: 5262014
  nsys-mod:
    cmd: calkit slurm batch --name nsys-mod --environment clima --dep 
      config/base.yml --dep config/smag.yml --dep ClimaAtmos.jl-mod/src --dep 
      ClimaAtmos.jl-mod/toml --dep 
      ClimaAtmos.jl-mod/.buildkite/Manifest-v1.11.toml --dep 
      ClimaAtmos.jl/perf/benchmark_step.jl --out results/nsys/mod.nsys-rep -s 
      --gpus=1 -s --time=60 -- scripts/run-nsys.sh results/nsys/mod 
      ClimaAtmos.jl-mod/.buildkite config/base.yml config/smag.yml
    deps:
    - path: ClimaAtmos.jl-mod/.buildkite/Manifest-v1.11.toml
      hash: md5
      md5: 960b94f8e8dc62e1ef00310b21171099
      size: 106103
    - path: ClimaAtmos.jl-mod/src
      hash: md5
      md5: f93e75145256d8cfdea345ebe162185b.dir
      size: 1318229
      nfiles: 101
    - path: ClimaAtmos.jl-mod/toml
      hash: md5
      md5: f6943f469c23e41ed04469503e7b9563.dir
      size: 11921
      nfiles: 36
    - path: ClimaAtmos.jl/perf/benchmark_step.jl
      hash: md5
      md5: e4e56e0353b6c5130c4e3fc03082c211
      size: 2082
    - path: config/base.yml
      hash: md5
      md5: 4756cdb867a59bff0c1f2cb99084db18
      size: 3659
    - path: config/smag.yml
      hash: md5
      md5: d953bd59bd767f59488f1b95350864c4
      size: 22
    - path: scripts/run-nsys.sh
      hash: md5
      md5: f83d8ec0a4bd8e2cd5513b64079b7b02
      size: 1546
    outs:
    - path: .calkit/slurm/logs/nsys-mod.out
      hash: md5
      md5: ecb0728d6243c46b0fd57e8f1c4cb347
      size: 14757
    - path: results/nsys/mod.nsys-rep
      hash: md5
      md5: fb7eac095e99d12705aff3941fda2ca3
      size: 5329470
  nsys-baseline-to-sqlite:
    cmd: ' bash --noprofile --norc -c "nsys export results/nsys/baseline.nsys-rep
      -t sqlite -o results/nsys/baseline.sqlite"'
    deps:
    - path: results/nsys/baseline.nsys-rep
      hash: md5
      md5: 9053a606dafce7693f47f509a7217090
      size: 5262014
    outs:
    - path: results/nsys/baseline.sqlite
      hash: md5
      md5: a2d9b886f35645956dcef93a4eb3b892
      size: 10641408
  nsys-mod-to-sqlite:
    cmd: ' bash --noprofile --norc -c "nsys export results/nsys/mod.nsys-rep -t sqlite
      -o results/nsys/mod.sqlite"'
    deps:
    - path: results/nsys/mod.nsys-rep
      hash: md5
      md5: fb7eac095e99d12705aff3941fda2ca3
      size: 5329470
    outs:
    - path: results/nsys/mod.sqlite
      hash: md5
      md5: a234b40f49d33eff007270ccb25f3496
      size: 10690560
  summarize:
    cmd: calkit xenv -n py --no-check -- python scripts/summarize.py
    deps:
    - path: .calkit/env-locks/py
      hash: md5
      md5: 6beae9447789bebe45f6f71283658a1e.dir
      size: 970
      nfiles: 1
    - path: results/nsys/baseline.sqlite
      hash: md5
      md5: a2d9b886f35645956dcef93a4eb3b892
      size: 10641408
    - path: results/nsys/mod.sqlite
      hash: md5
      md5: a234b40f49d33eff007270ccb25f3496
      size: 10690560
    - path: scripts/summarize.py
      hash: md5
      md5: 07c34af8e650da2ed6884efa945adf97
      size: 987
    outs:
    - path: results/summary.json
      hash: md5
      md5: f8ca9498fae3780d86ec1cb6cd303cc3
      size: 379
