Loading climacommon/2025_05_15
  Loading requirement: climaauth/2025_05_15 openmpi/4.1.5-mpitrampoline
    julia/1.11.5 cuda/julia-pref
┌ Warning: CUDA runtime library `libcublasLt.so.13` was loaded from a system path, `/usr/local/cuda/lib64/libcublasLt.so.13`.
│ This may cause errors.
│ 
│ If you're running under a profiler, this situation is expected. Otherwise,
│ ensure that your library path environment variable (e.g., `PATH` on Windows
│ or `LD_LIBRARY_PATH` on Linux) does not include CUDA library paths.
│ 
│ In any other case, please file an issue.
└ @ CUDA ~/.julia/packages/CUDA/TPbi4/src/initialization.jl:218
┌ Warning: CUDA runtime library `libnvJitLink.so.13` was loaded from a system path, `/usr/local/cuda/lib64/libnvJitLink.so.13`.
│ This may cause errors.
│ 
│ If you're running under a profiler, this situation is expected. Otherwise,
│ ensure that your library path environment variable (e.g., `PATH` on Windows
│ or `LD_LIBRARY_PATH` on Linux) does not include CUDA library paths.
│ 
│ In any other case, please file an issue.
└ @ CUDA ~/.julia/packages/CUDA/TPbi4/src/initialization.jl:218
┌ Warning: CUDA runtime library `libcusparse.so.12` was loaded from a system path, `/usr/local/cuda/lib64/libcusparse.so.12`.
│ This may cause errors.
│ 
│ If you're running under a profiler, this situation is expected. Otherwise,
│ ensure that your library path environment variable (e.g., `PATH` on Windows
│ or `LD_LIBRARY_PATH` on Linux) does not include CUDA library paths.
│ 
│ In any other case, please file an issue.
└ @ CUDA ~/.julia/packages/CUDA/TPbi4/src/initialization.jl:218
Status `~/calkit/clima-horizontal-diffusion/ClimaAtmos.jl-mod/.buildkite/Project.toml`
  [c7e460c6] ArgParse v1.2.0
  [a14bc488] ArtifactWrappers v0.2.0
  [6e4b80f9] BenchmarkTools v1.6.3
⌃ [052768ef] CUDA v5.8.5
  [13f3f980] CairoMakie v0.15.8
  [29b5916a] ClimaAnalysis v0.5.20
  [b2c96348] ClimaAtmos v0.32.0 `..`
  [3a4d1b5c] ClimaComms v0.6.10
⌃ [d414da3d] ClimaCore v0.14.43
  [c2caaa1d] ClimaCoreSpectra v0.1.4
  [d934ef94] ClimaCoreTempestRemap v0.3.18
⌅ [1ecacbb8] ClimaDiagnostics v0.2.15
  [e0c89595] ClimaReproducibilityTests v0.1.1
  [595c0a79] ClimaTimeSteppers v0.8.5
  [b3f4f4ca] ClimaUtilities v0.1.27
⌃ [2b5f629d] DiffEqBase v6.183.2
  [f67ccb44] HDF5 v0.17.2
⌅ [a98d9a8b] Interpolations v0.15.1
  [8197267c] IntervalSets v0.7.13
⌅ [c3a54625] JET v0.9.20
  [033835bb] JLD2 v0.6.3
  [682c06a0] JSON v1.3.0
  [ba0b0d4f] Krylov v0.10.3
  [da04e1cc] MPI v0.20.23
⌃ [85f8d34a] NCDatasets v0.14.8
  [0d71be07] NullBroadcasts v0.1.0
  [bac558e1] OrderedCollections v1.8.1
  [76d61242] PrecompileCI v0.1.0 `PrecompileCI`
⌅ [08abe8d2] PrettyTables v2.4.0
  [efd6af41] ProfileCanvas v0.1.7
⌃ [295af30f] Revise v3.7.5
⌅ [0bca4576] SciMLBase v2.112.0
⌅ [aa65fe97] SnoopCompile v3.1.4
⌅ [e2b509da] SnoopCompileCore v3.0.0
  [10745b16] Statistics v1.11.1
  [2913bbd2] StatsBase v0.34.9
  [ddb6d928] YAML v0.4.16
  [9c32591e] Poppler_jll v24.6.0+0
  [9abbd945] Profile v1.11.0
  [9a3f8284] Random v1.11.0
  [8dfed614] Test v1.11.0
Info Packages marked with ⌃ and ⌅ have new versions available. Those with ⌃ may be upgradable, but those with ⌅ are restricted by compatibility constraints from upgrading. To see why use `status --outdated`
┌ Warning: CUDA runtime library `libcublasLt.so.13` was loaded from a system path, `/usr/local/cuda/lib64/libcublasLt.so.13`.
│ This may cause errors.
│ 
│ If you're running under a profiler, this situation is expected. Otherwise,
│ ensure that your library path environment variable (e.g., `PATH` on Windows
│ or `LD_LIBRARY_PATH` on Linux) does not include CUDA library paths.
│ 
│ In any other case, please file an issue.
└ @ CUDA ~/.julia/packages/CUDA/TPbi4/src/initialization.jl:218
┌ Warning: CUDA runtime library `libnvJitLink.so.13` was loaded from a system path, `/usr/local/cuda/lib64/libnvJitLink.so.13`.
│ This may cause errors.
│ 
│ If you're running under a profiler, this situation is expected. Otherwise,
│ ensure that your library path environment variable (e.g., `PATH` on Windows
│ or `LD_LIBRARY_PATH` on Linux) does not include CUDA library paths.
│ 
│ In any other case, please file an issue.
└ @ CUDA ~/.julia/packages/CUDA/TPbi4/src/initialization.jl:218
┌ Warning: CUDA runtime library `libcusparse.so.12` was loaded from a system path, `/usr/local/cuda/lib64/libcusparse.so.12`.
│ This may cause errors.
│ 
│ If you're running under a profiler, this situation is expected. Otherwise,
│ ensure that your library path environment variable (e.g., `PATH` on Windows
│ or `LD_LIBRARY_PATH` on Linux) does not include CUDA library paths.
│ 
│ In any other case, please file an issue.
└ @ CUDA ~/.julia/packages/CUDA/TPbi4/src/initialization.jl:218
[ Info: Active project: /home/pbachant/calkit/clima-horizontal-diffusion/ClimaAtmos.jl-mod/.buildkite
┌ Warning: Failed to convert `config_dict["vert_diff"] = false` to default type String, keeping original value
└ @ ClimaAtmos ~/calkit/clima-horizontal-diffusion/ClimaAtmos.jl-mod/src/solver/yaml_helper.jl:78
┌ Info: Making AtmosConfig with config files: 
│    /home/pbachant/calkit/clima-horizontal-diffusion/ClimaAtmos.jl-mod/src/solver/../../config/default_configs/default_config.yml
│    config/base.yml
└    config/smag.yml
[ Info: Running on CUDADevice
[ Info: Setting up single-process ClimaAtmos run
┌ Info: Time info:
│   dt = "30secs"
│   t_start = "0secs"
│   t_end = "3days"
└   floor_n_steps = 8640
┌ Info: numerics 
│        `energy_q_tot_upwinding`::`Val{:vanleer_limiter}`
│              `tracer_upwinding`::`Val{:first_order}`
│     `edmfx_mse_q_tot_upwinding`::`Val{:first_order}`
│       `edmfx_sgsflux_upwinding`::`Val{:none}`
│        `edmfx_tracer_upwinding`::`Val{:first_order}`
│       `test_dycore_consistency`::`Nothing`
│          `reproducible_restart`::`Nothing`
│                       `limiter`::`Nothing`
│                     `diff_mode`::`ClimaAtmos.Explicit`
└                     `hyperdiff`::`ClimaAtmos.ClimaHyperdiffusion{Float32}`
┌ Info: AtmosModel: 
│ 
│                             `water`::`ClimaAtmos.AtmosWater{ClimaAtmos.NonEquilMoistModel, ClimaAtmos.Microphysics1Moment, ClimaAtmos.GridScaleCloud, ClimaAtmos.Explicit, Nothing}`
│                         `scm_setup`::`ClimaAtmos.SCMSetup{Nothing, Nothing, Nothing, Bool, Nothing}`
│                         `radiation`::`ClimaAtmos.AtmosRadiation{Nothing, ClimaAtmos.IdealizedOzone, Nothing, ClimaAtmos.IdealizedInsolation}`
│                          `turbconv`::`ClimaAtmos.AtmosTurbconv{ClimaAtmos.EDMFXModel{ClimaAtmos.PiGroupsEntrainment, ClimaAtmos.BuoyancyVelocityDetrainment, Val{true}, Val{true}, Val{true}, Val{false}, Val{false}, ClimaAtmos.SmoothMinimumBlending}, Nothing, ClimaAtmos.Explicit, ClimaAtmos.Explicit, ClimaAtmos.Explicit, ClimaAtmos.Explicit, ClimaAtmos.Explicit, ClimaAtmos.SmagorinskyLilly{:UV}, Nothing, Nothing}`
│                   `prescribed_flow`::`Nothing`
│                      `gravity_wave`::`ClimaAtmos.AtmosGravityWave{Nothing, Nothing}`
│                `vertical_diffusion`::`Nothing`
│                            `sponge`::`ClimaAtmos.AtmosSponge{Nothing, ClimaAtmos.RayleighSponge{Float32}}`
│                           `surface`::`ClimaAtmos.AtmosSurface{ClimaAtmos.ZonallySymmetricSST, ClimaAtmos.SlabOceanSST{Int64}, ClimaAtmos.ConstantAlbedo{Float32}}`
└                          `numerics`::`ClimaAtmos.AtmosNumerics{Val{:vanleer_limiter}, Val{:first_order}, Val{:first_order}, Val{:none}, Val{:first_order}, Nothing, Nothing, Nothing, ClimaAtmos.Explicit, ClimaAtmos.ClimaHyperdiffusion{Float32}}`
[ Info: Using Hughes2023Topography orography
[ Info: SLEVE mesh warp (eta=0.7, s=10.0)
┌ Info: Simulation info
│   job_id = "mod_smag"
└   output_dir = "output/mod_smag/output_0000"
┌ Info: Simulation Grid: ExtrudedFiniteDifferenceGrid:
│   horizontal:
│     context: SingletonCommsContext using CUDADevice
│     mesh: 16×16×6-element EquiangularCubedSphere of SphereDomain: radius = 6.371e6
│     quadrature: 4-point Gauss-Legendre-Lobatto quadrature
│   vertical:
└     mesh: 43-element IntervalMesh of IntervalDomain: z ∈ [0.0,30000.0] (:bottom, :top)
[ Info: Allocating Y: 11.721 s (17851882 allocations: 838.18 MiB)
[ Info: using deep atmosphere
[ Info: Allocating cache (p): 87.475 s (220793029 allocations: 10.85 GiB)
[ Info: Using ODE config: `ClimaTimeSteppers.ARS343`
[ Info: ode_configuration: 730.151 ms (1383922 allocations: 68.56 MiB)
[ Info: Progress logging enabled
[ Info: Checking NaNs in the state every 1024 steps
[ Info: get_callbacks: 274.475 ms (402317 allocations: 20.55 MiB)
[ Info: Saving accumulated diagnostics to disk with frequency: 
[ Info: DictWriter: String[]
[ Info: HDF5Writer: String[]
[ Info: NetCDFWriter: ["rhoa_60d_inst", "ua_60d_inst", "va_60d_inst", "wa_60d_inst", "ta_60d_inst", "hus_60d_inst", "clw_60d_inst", "cli_60d_inst", "hussn_60d_inst", "husra_60d_inst"]
[ Info: initializing diagnostics: 6.532 s (14948202 allocations: 1.51 GiB)
[ Info: Prepared SciMLBase.CallbackSet callbacks: 8.916 ms (561 allocations: 27.34 KiB)
[ Info: n_steps_per_cycle_per_cb (non diagnostics): [1024, 1, 360]
[ Info: n_steps_per_cycle (non diagnostics): 46080
┌ Info: Jacobian algorithm: ManualSparseJacobian(
│   topography_flag = ClimaAtmos.UseDerivative(),
│   diffusion_flag = ClimaAtmos.IgnoreDerivative(),
│   sgs_advection_flag = ClimaAtmos.IgnoreDerivative(),
│   sgs_entr_detr_flag = ClimaAtmos.IgnoreDerivative(),
│   sgs_mass_flux_flag = ClimaAtmos.IgnoreDerivative(),
│   sgs_nh_pressure_flag = ClimaAtmos.IgnoreDerivative(),
│   sgs_vertdiff_flag = ClimaAtmos.IgnoreDerivative(),
│   approximate_solve_iters = 2,
└ )
[ Info: Define ode function: 1.516 s (1839766 allocations: 78.35 MiB)
[ Info: init integrator: 14.902 s (18459582 allocations: 952.81 MiB)
[ Info: Added diagnostics: 124.69 s (28800688 allocations: 12.64 GiB)
┌ Info: Progress
│   simulation_time = "30 seconds, 1 microsecond"
│   n_steps_completed = 1
│   wall_time_per_step = "0 seconds"
│   wall_time_total = "0 seconds"
│   wall_time_remaining = "0 seconds"
│   wall_time_spent = "0 seconds"
│   percent_complete = "0.0%"
│   estimated_sypd = "Inf"
│   date_now = 2025-12-22T08:04:45.098
└   estimated_finish_date = 2025-12-22T08:04:45.098
┌ Info: Progress
│   simulation_time = "1 minute, 2 microseconds"
│   n_steps_completed = 2
│   wall_time_per_step = "15 seconds, 194 milliseconds"
│   wall_time_total = "1 day, 12 hours"
│   wall_time_remaining = "1 day, 12 hours"
│   wall_time_spent = "30 seconds, 388 milliseconds"
│   percent_complete = "0.0%"
│   estimated_sypd = "0.005 (sdpd_estimate = 1.974)"
│   date_now = 2025-12-22T08:05:00.284
└   estimated_finish_date = 2025-12-23T20:32:29.284
┌ Info: Progress
│   simulation_time = "2 minutes, 4 microseconds"
│   n_steps_completed = 4
│   wall_time_per_step = "7 seconds, 719 milliseconds"
│   wall_time_total = "18 hours, 31 minutes"
│   wall_time_remaining = "18 hours, 31 minutes"
│   wall_time_spent = "30 seconds, 876 milliseconds"
│   percent_complete = "0.0%"
│   estimated_sypd = "0.011"
│   date_now = 2025-12-22T08:05:00.636
└   estimated_finish_date = 2025-12-23T02:36:02.636
┌ Info: Progress
│   simulation_time = "4 minutes, 8 microseconds"
│   n_steps_completed = 8
│   wall_time_per_step = "3 seconds, 951 milliseconds"
│   wall_time_total = "9 hours, 29 minutes"
│   wall_time_remaining = "9 hours, 28 minutes"
│   wall_time_spent = "31 seconds, 615 milliseconds"
│   percent_complete = "0.1%"
│   estimated_sypd = "0.021"
│   date_now = 2025-12-22T08:05:01.376
└   estimated_finish_date = 2025-12-22T17:33:35.376
┌ Info: Progress
│   simulation_time = "8 minutes, 16 microseconds"
│   n_steps_completed = 16
│   wall_time_per_step = "2 seconds, 68 milliseconds"
│   wall_time_total = "4 hours, 57 minutes"
│   wall_time_remaining = "4 hours, 57 minutes"
│   wall_time_spent = "33 seconds, 89 milliseconds"
│   percent_complete = "0.2%"
│   estimated_sypd = "0.04"
│   date_now = 2025-12-22T08:05:02.849
└   estimated_finish_date = 2025-12-22T13:02:18.849
┌ Info: Progress
│   simulation_time = "16 minutes, 32 microseconds"
│   n_steps_completed = 32
│   wall_time_per_step = "1 second, 124 milliseconds"
│   wall_time_total = "2 hours, 41 minutes"
│   wall_time_remaining = "2 hours, 41 minutes"
│   wall_time_spent = "35 seconds, 992 milliseconds"
│   percent_complete = "0.4%"
│   estimated_sypd = "0.073"
│   date_now = 2025-12-22T08:05:05.753
└   estimated_finish_date = 2025-12-22T10:46:28.753
┌ Info: Progress
│   simulation_time = "32 minutes, 65 microseconds"
│   n_steps_completed = 64
│   wall_time_per_step = "659 milliseconds, 199 microseconds"
│   wall_time_total = "1 hour, 34 minutes"
│   wall_time_remaining = "1 hour, 34 minutes"
│   wall_time_spent = "42 seconds, 188 milliseconds"
│   percent_complete = "0.7%"
│   estimated_sypd = "0.125"
│   date_now = 2025-12-22T08:05:11.949
└   estimated_finish_date = 2025-12-22T09:39:25.949
┌ Info: Progress
│   simulation_time = "1 hour, 4 minutes"
│   n_steps_completed = 128
│   wall_time_per_step = "422 milliseconds, 448 microseconds"
│   wall_time_total = "1 hour, 49 seconds"
│   wall_time_remaining = "59 minutes, 55 seconds"
│   wall_time_spent = "54 seconds, 73 milliseconds"
│   percent_complete = "1.5%"
│   estimated_sypd = "0.194"
│   date_now = 2025-12-22T08:05:23.834
└   estimated_finish_date = 2025-12-22T09:05:19.834
┌ Info: Progress
│   simulation_time = "2 hours, 8 minutes"
│   n_steps_completed = 256
│   wall_time_per_step = "305 milliseconds, 438 microseconds"
│   wall_time_total = "43 minutes, 58 seconds"
│   wall_time_remaining = "42 minutes, 40 seconds"
│   wall_time_spent = "1 minute, 18 seconds"
│   percent_complete = "3.0%"
│   estimated_sypd = "0.269"
│   date_now = 2025-12-22T08:05:47.952
└   estimated_finish_date = 2025-12-22T08:48:28.952
┌ Info: Progress
│   simulation_time = "4 hours, 16 minutes"
│   n_steps_completed = 512
│   wall_time_per_step = "246 milliseconds, 241 microseconds"
│   wall_time_total = "35 minutes, 27 seconds"
│   wall_time_remaining = "33 minutes, 21 seconds"
│   wall_time_spent = "2 minutes, 6 seconds"
│   percent_complete = "5.9%"
│   estimated_sypd = "0.334"
│   date_now = 2025-12-22T08:06:35.836
└   estimated_finish_date = 2025-12-22T08:39:57.836
┌ Info: Progress
│   simulation_time = "7 hours, 52 minutes"
│   n_steps_completed = 945
│   wall_time_per_step = "218 milliseconds, 225 microseconds"
│   wall_time_total = "31 minutes, 25 seconds"
│   wall_time_remaining = "27 minutes, 59 seconds"
│   wall_time_spent = "3 minutes, 26 seconds"
│   percent_complete = "10.9%"
│   estimated_sypd = "0.376"
│   date_now = 2025-12-22T08:07:55.984
└   estimated_finish_date = 2025-12-22T08:35:55.984
┌ Info: Progress
│   simulation_time = "8 hours, 32 minutes"
│   n_steps_completed = 1024
│   wall_time_per_step = "215 milliseconds, 658 microseconds"
│   wall_time_total = "31 minutes, 3 seconds"
│   wall_time_remaining = "27 minutes, 22 seconds"
│   wall_time_spent = "3 minutes, 40 seconds"
│   percent_complete = "11.9%"
│   estimated_sypd = "0.381"
│   date_now = 2025-12-22T08:08:10.595
└   estimated_finish_date = 2025-12-22T08:35:33.595
┌ Info: Progress
│   simulation_time = "12 hours, 8 minutes"
│   n_steps_completed = 1457
│   wall_time_per_step = "206 milliseconds, 791 microseconds"
│   wall_time_total = "29 minutes, 46 seconds"
│   wall_time_remaining = "24 minutes, 45 seconds"
│   wall_time_spent = "5 minutes, 1 second"
│   percent_complete = "16.9%"
│   estimated_sypd = "0.397"
│   date_now = 2025-12-22T08:09:31.056
└   estimated_finish_date = 2025-12-22T08:34:17.056
┌ Info: Progress
│   simulation_time = "15 hours, 44 minutes"
│   n_steps_completed = 1890
│   wall_time_per_step = "202 milliseconds, 134 microseconds"
│   wall_time_total = "29 minutes, 6 seconds"
│   wall_time_remaining = "22 minutes, 44 seconds"
│   wall_time_spent = "6 minutes, 22 seconds"
│   percent_complete = "21.9%"
│   estimated_sypd = "0.406"
│   date_now = 2025-12-22T08:10:51.794
└   estimated_finish_date = 2025-12-22T08:33:36.794
┌ Info: Progress
│   simulation_time = "17 hours, 4 minutes"
│   n_steps_completed = 2048
│   wall_time_per_step = "201 milliseconds, 121 microseconds"
│   wall_time_total = "28 minutes, 57 seconds"
│   wall_time_remaining = "22 minutes, 5 seconds"
│   wall_time_spent = "6 minutes, 51 seconds"
│   percent_complete = "23.7%"
│   estimated_sypd = "0.408"
│   date_now = 2025-12-22T08:11:21.657
└   estimated_finish_date = 2025-12-22T08:33:27.657
ERROR: LoadError: Found NaN
Stacktrace:
  [1] error(s::String)
    @ Base ./error.jl:35
  [2] check_nans
    @ ~/calkit/clima-horizontal-diffusion/ClimaAtmos.jl-mod/src/callbacks/callbacks.jl:332 [inlined]
  [3] #519
    @ ~/calkit/clima-horizontal-diffusion/ClimaAtmos.jl-mod/src/callbacks/get_callbacks.jl:254 [inlined]
  [4] AtmosCallback
    @ ~/calkit/clima-horizontal-diffusion/ClimaAtmos.jl-mod/src/solver/types.jl:1182 [inlined]
  [5] unrolled_foreach
    @ ~/.julia/packages/ClimaTimeSteppers/o2zml/src/integrators.jl:224 [inlined]
  [6] unrolled_foreach
    @ ~/.julia/packages/ClimaTimeSteppers/o2zml/src/integrators.jl:229 [inlined]
  [7] unrolled_foreach
    @ ~/.julia/packages/ClimaTimeSteppers/o2zml/src/integrators.jl:230 [inlined]
  [8] __step!(integrator::ClimaTimeSteppers.DistributedODEIntegrator{…})
    @ ClimaTimeSteppers ~/.julia/packages/ClimaTimeSteppers/o2zml/src/integrators.jl:255
  [9] step!(integrator::ClimaTimeSteppers.DistributedODEIntegrator{…})
    @ ClimaTimeSteppers ~/.julia/packages/ClimaTimeSteppers/o2zml/src/integrators.jl:200
 [10] macro expansion
    @ ~/calkit/clima-horizontal-diffusion/scripts/run.jl:64 [inlined]
 [11] top-level scope
    @ ~/.julia/packages/CUDA/TPbi4/lib/cudadrv/events.jl:121
in expression starting at /home/pbachant/calkit/clima-horizontal-diffusion/scripts/run.jl:62
